     1                                  ; =====================================================================================================================
     2                                  ; Program name: "Array Management System". This program demonstrates how to pass an array
     3                                  ; Through assembly language and gathers the sum of the array. The max array length is 8.
     4                                  ; Copyright (C) 2023 Dylan Zuniga
     5                                  ; =====================================================================================================================
     6                                  ; Author Information
     7                                  ;     Author Name: Dylan Zuniga
     8                                  ;     Author Email: zuniga18dz@csu.fullerton.edu
     9                                  ;
    10                                  ; Program Information
    11                                  ;     Program Name: Array Management System
    12                                  ;     Programming Languages: One module in C, four in x86
    13                                  ;     Date Program Began: 2023-Sep-05
    14                                  ;     Date Program Completed: 2023-Sep-24
    15                                  ;     Date Comments Upgraded: 2023-Sep-24
    16                                  ;     Files in the program: main.c, manage.asm, input_array.asm, output_array.asm, sum_array.asm, run.sh
    17                                  ;     Status: Completed. Challenge Part not present in program.
    18                                  ;
    19                                  ; Purpose (Academic)
    20                                  ;     Allow's the user to input 8 numbers into an array and get the total sum of the array
    21                                  ;
    22                                  ; This file
    23                                  ;     File Name: input_array.asm
    24                                  ;     Langauge: x86
    25                                  ;     Syntax: Intel
    26                                  ;     Assemble: nasm -f elf64 -l input_list.lis -o input-asm.o input_array.asm
    27                                  ;     Link: gcc -m64 c-output.o manage-asm.o input-asm.o output-asm.o sum-asm.o -o arrayzz -fno-pie -no-pie -std=c++17
    28                                  ; ===== Begin code area ===============================================================================================
    29                                  
    30                                  global input_array
    31                                  extern scanf
    32                                  extern printf
    33                                  
    34                                  
    35                                  
    36                                  section .data
    37 00000000 200A00                      newline db " ", 10, 0
    38 00000003 256C6600                    floatformat db "%lf", 0
    39 00000007 257300                      stringformat db "%s", 0 
    40                                  
    41                                  section .bss
    42                                  
    43                                  section .text
    44                                  input_array:
    45                                  
    46                                  ; ======================================= 
    47                                  ;  * * * * * * * 16 PUSHES * * * * * * *  
    48                                  ; ======================================= 
    49 00000000 55                          push       rbp                                              
    50 00000001 4889E5                      mov        rbp, rsp                                         
    51 00000004 53                          push       rbx                                              
    52 00000005 51                          push       rcx                                              
    53 00000006 52                          push       rdx                                              
    54 00000007 56                          push       rsi                                              
    55 00000008 57                          push       rdi                                              
    56 00000009 4150                        push       r8                                               
    57 0000000B 4151                        push       r9                                               
    58 0000000D 4152                        push       r10                                              
    59 0000000F 4153                        push       r11                                              
    60 00000011 4154                        push       r12                                              
    61 00000013 4155                        push       r13                                              
    62 00000015 4156                        push       r14                                              
    63 00000017 4157                        push       r15                                              
    64 00000019 9C                          pushf
    65                                  
    66                                  ; =======================================
    67                                  ;  * * * START OF THE APPLICATION * * *
    68                                  ; =======================================
    69                                  
    70                                  ; Print prompt
    71                                  
    72 0000001A 4989FD                      mov r13, rdi            ; r13 is the array
    73 0000001D 4989F6                      mov r14, rsi            ; r14 is the number of cells
    74 00000020 4D31FF                      xor r15, r15            ; r15 == 0
    75 00000023 EB00                        jmp input_begin
    76                                  input_begin:
    77                                  
    78 00000025 4D39F7                      cmp r15, r14             ;if r15 >= r14
    79 00000028 7421                        je input_done            ;     then we are done
    80                                  
    81 0000002A 48BF-                       mov rdi, floatformat
    81 0000002C [0300000000000000] 
    82 00000034 4B8D74FD00                  lea rsi, [r13+8*r15]
    83 00000039 E8(00000000)                call scanf
    84                                    
    85 0000003E 4898                        cdqe                   
    86 00000040 4883F8FF                    cmp rax, -1                 ;checks for control_d
    87 00000044 7405                        je input_done               ;control_d is pressed
    88                                      
    89 00000046 49FFC7                      inc r15
    90                                  
    91 00000049 EBDA                        jmp input_begin                ;Repeat the loop
    92                                  
    93                                  input_done:
    94                                  
    95 0000004B 48BF-                       mov rdi, newline
    95 0000004D [0000000000000000] 
    96 00000055 E8(00000000)                call printf
    97                                  
    98 0000005A 4C89F8                      mov rax, r15            ; returns the count of the array
    99                                      
   100                                  
   101                                  ; =======================================
   102                                  ; * * * * * * * * 16 POPS * * * * * * * *
   103                                  ; =======================================
   104 0000005D 9D                          popf                                                        
   105 0000005E 415F                        pop        r15                                              
   106 00000060 415E                        pop        r14                                              
   107 00000062 415D                        pop        r13                                              
   108 00000064 415C                        pop        r12                                              
   109 00000066 415B                        pop        r11                                              
   110 00000068 415A                        pop        r10                                              
   111 0000006A 4159                        pop        r9                                               
   112 0000006C 4158                        pop        r8                                               
   113 0000006E 5F                          pop        rdi                                              
   114 0000006F 5E                          pop        rsi                                              
   115 00000070 5A                          pop        rdx                                              
   116 00000071 59                          pop        rcx                                              
   117 00000072 5B                          pop        rbx                                              
   118 00000073 5D                          pop        rbp      
   119                                  
   120 00000074 C3                          ret
